/* Window Engine - MIT License - Copyright (c) 2019 Gauthier Staehler */

/* Modifications 2021 Stella Mahler - MIT License */

 window.onload = function popup() {setTimeout(function() { createWindowSexyMessageService(12); }, 5000);};



 document.getElementById("buttonSexyMessageService").onclick = function(){

   var x = document.getElementById("sexyMessageFirst");
   if (x.style.display === "none") {
     x.style.display = "block";
   } else {
     x.style.display = "none";
   }
   var y = document.getElementById("sexyMessageSecond");
   if (y.style.display === "none") {
     y.style.display = "block";
   } else {
     y.style.display = "none";
   }
 };

const metaTag = document.createElement("meta");
metaTag.name = "viewport", metaTag.content = "user-scalable=0", document.getElementsByTagName("head")[0].appendChild(metaTag);
const lastWindow = document.getElementsByClassName("windowGroup")[0].lastElementChild.id.substring(6),
  active = document.getElementsByClassName("window");
for (let e = 1; e <= lastWindow - 1; e++) createWindow(e);

createWindowMailboxLink(7);



function createWindow(e) {
  let t = document.getElementById("window" + e);
  t.firstElementChild.id = "window" + e + "header";
  let n = document.createElement("b");
  n.id = "closeButton" + e, n.innerHTML = " <img src='SVG/X.svg'/>  ", document.getElementById("window" + e + "header").insertBefore(n, document.getElementById("window" + e + "header").firstChild), document.getElementById("closeButton" + e).onclick = function() {
    i = document.getElementById("button" + e),
    i.classList.remove("projectSelected"),
    fadeOut(t)
  }, document.getElementById("button" + e).onclick = function() {
    i = document.getElementById("button" + e),
    i.classList.add("projectSelected"),
    "initial" === t.style.display ? activeWindow(t) : (t.style = "position: absolute;",
    randomTop = 20 + Math.floor(Math.random() * 500),
    randomLeft = 400 + Math.floor(Math.random() * 300),
    t.style = "top: "+ randomTop + "px; left:" + randomLeft + "px;"
    , fadeIn(t))
  }, dragElement(t)
}

function createWindowSexyMessageService(e) {
  let t = document.getElementById("window" + e);
  t.firstElementChild.id = "window" + e + "header";
/*  let n = document.createElement("b");
  n.id = "closeButton" + e, n.innerHTML = "x", document.getElementById("window" + e + "header").insertBefore(n, document.getElementById("window" + e + "header").firstChild), document.getElementById("closeButton" + e).onclick = function() {

    fadeOut(t)
  },*/
  document.getElementById("sexyCloseButtonFirst").onclick = function() {
    fadeOut(t)
  },
  document.getElementById("sexyCloseButtonSecond").onclick = function() {
    fadeOut(t)
  }
  , showPopup(t),
    dragElement(t)
}


function createWindowMailboxLink(e) {
  let t = document.getElementById("window" + e);


  document.getElementById("button_a_" + e).onclick = function() {
    i = document.getElementById("button" + e),
    i.classList.add("projectSelected"),
    "initial" === t.style.display ? activeWindow(t) : (t.style = "position: absolute;",
    randomTop = 20 + Math.floor(Math.random() * 500),
    randomLeft = 400 + Math.floor(Math.random() * 300),
    t.style = "top: "+ randomTop + "px; left:" + randomLeft + "px;"
    , fadeIn(t))
  }, dragElement(t)
}



function showPopup(t){
  "initial" === t.style.display ? activeWindow(t) : (t.style = "position: absolute;",
  randomTop = 20 + Math.floor(Math.random() * 500),
  randomLeft = 400 + Math.floor(Math.random() * 300),
  t.style = "top: "+ randomTop + "px; left:" + randomLeft + "px;"
  , fadeIn(t))
}



function dragElement(e) {
  var t = 0,
    n = 0,
    o = 0,
    c = 0;
  if ("ontouchstart" in document.documentElement) var i = 0,
    l = 0,
    d = 0,
    a = 0;

  function u(t) {
    if (!1 in document.documentElement && t.preventDefault(), o = t.clientX, c = t.clientY, "ontouchstart" in document.documentElement) try {
      d = t.touches[0].clientX, a = t.touches[0].clientY
    } catch (e) {}
    document.onmouseup = m, document.onmousemove = s, document.ontouchend = m, document.ontouchmove = s, activeWindow(document.getElementById(e.id))
  }

  function s(u) {
    u.preventDefault(), "ontouchstart" in document.documentElement ? (i = d - u.touches[0].clientX, l = a - u.touches[0].clientY, d = u.touches[0].clientX, a = u.touches[0].clientY, e.style.top = e.offsetTop - l + "px", e.style.left = e.offsetLeft - i + "px") : (t = o - u.clientX, n = c - u.clientY, o = u.clientX, c = u.clientY, e.style.top = e.offsetTop - n + "px", e.style.left = e.offsetLeft - t + "px")
  }

  function m() {
    document.onmouseup = null, document.onmousemove = null, document.ontouchend = null, document.ontouchmove = null
  }
  document.getElementById(e.id + "header") && (document.getElementById(e.id + "header").onmousedown = u, document.getElementById(e.id + "header").ontouchstart = u)
}

function fadeIn(e) {
  if (e.style.opacity = 0, e.style.display = "initial", e.classList.contains("fade")) var t = 0,
    n = setInterval(function() {
      (t += 30 / 70) >= 1 && (clearInterval(n), t = 1), e.style.opacity = t, activeWindow(e)
    }, 50);
  else e.style.opacity = "1", activeWindow(e)
}

function fadeOut(e) {
  if (e.classList.contains("fade")) var t = 1,
    n = setInterval(function() {
      (t -= 30 / 70) <= 0 && (clearInterval(n), t = 0, e.style.display = "none"), e.style.opacity = t
    }, 50);
  else e.style.display = "none", activeWindow(e)
}

function activeWindow(e) {
  for (let t = active.length - 1; t > -1; t--) active[t].classList.remove("windowActive"), e.className += " windowActive"
}



// Audio handles - https://stackoverflow.com/a/59048789 - @Stella
var track = document.getElementById('track');

var controlBtn = document.getElementById('play-pause');

function playPause() {
    if (track.paused) {
        track.play();
        //controlBtn.textContent = "Pause";
        controlBtn.className = "pause";
    } else {
        track.pause();
         //controlBtn.textContent = "Play";
        controlBtn.className = "play";
    }
}

controlBtn.addEventListener("click", playPause);
track.addEventListener("ended", function() {
  controlBtn.className = "play";
});
